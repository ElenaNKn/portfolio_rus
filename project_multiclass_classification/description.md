# Многоклассовая классификация при дисбалансе классов

## Описание проекта

В рамках данного проекта рассмотрена задача многоклассовой классификации при дисбалансе классов в исходных данных.

Выполнение проекта осуществлялось на базе датасета `load_wine` из библиотеки `sklearn.datasets`. Построен ряд моделей (логистическая регрессия, метод опорных векторов, k ближайших соседей, дерево решений) для предсказания класса вина в зависимости от его характеристик.

## Этапы выполнения проекта

1. Анализ датасета (EDA), оценка попарной корреляции признаков, проверка наличия пропусков и выбросов, стандартизация признаков. Обоснование целевой метрики.

2. Построение модели логистической регрессии. Поиск по кросс-валидации оптимальных параметров. Оценка качества модели на тестовом датасете

3. Построение модели многоклассовой классификации на основе метода опорных векторов. Созадное кастомного подхода для поиска оптимальных параметров модели (коэффициента регуляризации и типа ядра). Оценка качества модели на тестовом датасете 

4. Построение модели многоклассовой классификации на основе алгоритма KNN. Определение оптимального количества соседей и метода расчета весовых коэффициентов для соседей. Оценка качества модели на тестовом датасете

5. Построение модели классификации на основе дерева решений. Подбор оптимальных параметров. Визуализация дерева решений и оценка качества модели на тестовом датасете 

## Результаты и выводы

Поскольку рассматриваемая задача относится к многоклассовой классификации и с учетом установленного дисбаланса классов в качестве целевой метрики принята метрика `f1_weighted` (взвешенный f1-score).

Для рассматриваемого датасета показана равнозначность применения подходов one-versus-rest и one-versus-one при переходе к бинарной классификации. Это обусловлено сравнительно небольшим размером датасета и малым количеством классов (one-versus-rest был бы предпочтительней при большом количестве классов, one-versus-one - при большом датасете).

Построена модель логистической регрессии. На основании перебора по кроссвалидации (с применением `GridSearchCV`) получено оптимальное значение коэффициента регуляризации С=0.06. `f1_weighted` для построенной модели логистической регрессии с подобранным оптимальным значением коэффициента регуляризации на тестовой выборке составил 1.

Построена модель многоклассовой классификации на основе метода опорных векторов (комплексная модель `OneVsRestClassifier(SVC())`). Подбор по кросс-валидации параметров для созданной модели был реализован в явном виде, найдено оптимальное значение коэффициента регуляризации и тип ядра. Целевая метрика `f1_weighted` для построенной модели на тестовой выборке составила 0,96 (модель неверно классифицировала по 1 объекту из класса 1 и класса 2; объекты класса 0 тестовой выборки были классифицированы безошибочно).

Построена модель многоклассовой классификации на основе алгоритма KNN. Перебором по кросс-валидации определено оптимальное количество соседей и метод расчета весовых коэффициентов для соседей. Целевая метрика `f1_weighted` для построенной модели на тестовой выборке составила 0,98. Более детальный анализ показал, что модель неверно классифицировала только 1 объект класса 1 (ошибочно отнесен к классу 2). То есть в целом модель работает хорошо.

Построена модель классификации на основе дерева решений и выполнен подбор оптимальных параметров. Наибольшее значение метрики `f1_weighted `, которое было достигнуто на тестовой выборке для данной модели составило 0.89, что существенно хуже, чем у ранее рассмотренных моделей. Модель безошибочно классифицировала объекты класса 0, но сравнительно плохо определяла объекты класса 1 (true positive = 14, false negative = 4). Модель может быть улучшена путем подбора оптимальных весовых коэффициентов для классов, а также переходом к композициям деревьев. Вместе с тем обучение дерева занимает больше времени, чем логистической регрессии.

Таким образом, в качестве окончательной модели принята модель, построенная на основе логистической регрессии с коэффициентом регуляризации С=0.06, автоматической балансировкой данных (class_weight='balanced') и one-versus-rest подходом для учета многоклассовой постановки задачи (multi_class='ovr'), безошибочно классифицировавшая все объекты тестовой выборки.

Ноутбук проекта доступен по ссылке: ["Многоклассовая классификация при дисбалансе классов"](https://github.com/ElenaNKn/portfolio_rus/blob/master/project_multiclass_classification/project.ipynb)